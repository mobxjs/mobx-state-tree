<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Overview &amp; Philosophy · MobX-state-tree</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;div id=&quot;codefund&quot;&gt;&lt;/div&gt;"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Overview &amp; Philosophy · MobX-state-tree"/><meta property="og:type" content="website"/><meta property="og:url" content="https://mobx-state-tree.js.org//"/><meta property="og:description" content="&lt;div id=&quot;codefund&quot;&gt;&lt;/div&gt;"/><meta name="twitter:card" content="summary"/><meta name="robots" content="noindex"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon.ico" alt="MobX-state-tree"/><h2 class="headerTitleWithLogo">MobX-state-tree</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive siteNavItemActive"><a href="/intro/philosophy" target="_self">Docs</a></li><li class=""><a href="https://opencollective.com/mobx" target="_self">Sponsor</a></li><li class=""><a href="https://github.com/mobxjs/mobx-state-tree" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Introduction</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Introduction<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/intro/philosophy">Overview &amp; Philosophy</a></li><li class="navListItem"><a class="navItem" href="/intro/installation">Installation</a></li><li class="navListItem"><a class="navItem" href="/intro/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/intro/examples">Examples</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/overview/types">Types overview</a></li><li class="navListItem"><a class="navItem" href="/overview/api">API overview</a></li><li class="navListItem"><a class="navItem" href="/overview/hooks">Lifecycle hooks overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Basic Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/concepts/trees">Types, trees &amp; state</a></li><li class="navListItem"><a class="navItem" href="/concepts/creating-models">Creating models</a></li><li class="navListItem"><a class="navItem" href="/concepts/tree-semantics">Tree semantics in detail</a></li><li class="navListItem"><a class="navItem" href="/concepts/composing-trees">Composing trees</a></li><li class="navListItem"><a class="navItem" href="/concepts/actions">Actions</a></li><li class="navListItem"><a class="navItem" href="/concepts/views">Derived values</a></li><li class="navListItem"><a class="navItem" href="/concepts/snapshots">Snapshots</a></li><li class="navListItem"><a class="navItem" href="/concepts/references">Identifiers and references</a></li><li class="navListItem"><a class="navItem" href="/concepts/async-actions">Asynchronous actions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Advanced Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/concepts/patches">Patches</a></li><li class="navListItem"><a class="navItem" href="/concepts/listeners">Listening to changes</a></li><li class="navListItem"><a class="navItem" href="/concepts/dependency-injection">Dependency Injection</a></li><li class="navListItem"><a class="navItem" href="/concepts/middleware">Middleware</a></li><li class="navListItem"><a class="navItem" href="/concepts/reconciliation">Reconciliation</a></li><li class="navListItem"><a class="navItem" href="/concepts/volatiles">Volatile state</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Tips<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/tips/resources">Talks &amp; Blogs</a></li><li class="navListItem"><a class="navItem" href="/tips/contributing">Contributing</a></li><li class="navListItem"><a class="navItem" href="/tips/faq">Frequently Asked Questions</a></li><li class="navListItem"><a class="navItem" href="/tips/typescript">TypeScript</a></li><li class="navListItem"><a class="navItem" href="/tips/circular-deps">Circular dependencies</a></li><li class="navListItem"><a class="navItem" href="/tips/inheritance">Simulating inheritance</a></li><li class="navListItem"><a class="navItem" href="/tips/snapshots-as-values">Using snapshots as values</a></li><li class="navListItem"><a class="navItem" href="/tips/more-tips">Miscellaneous Tips</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/mobxjs/mobx-state-tree/edit/master/docs/intro/philosophy.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Overview &amp; Philosophy</h1></header><article><div><span><div id="codefund"></div>
<h1><a class="anchor" aria-hidden="true" id="philosophy-overview"></a><a href="#philosophy-overview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Philosophy &amp; Overview</h1>
<p><code>mobx-state-tree</code> is a state container that combines the <em>simplicity and ease of mutable data</em> with the <em>traceability of immutable data</em> and the <em>reactiveness and performance of observable data</em>.</p>
<p>Simply put, mobx-state-tree tries to combine the best features of both immutability (transactionality, traceability and composition) and mutability (discoverability, co-location and encapsulation) based approaches to state management; everything to provide the best developer experience possible.
Unlike MobX itself, mobx-state-tree is very opinionated about how data should be structured and updated.
This makes it possible to solve many common problems out of the box.</p>
<p>Central in MST (mobx-state-tree) is the concept of a <em>living tree</em>. The tree consists of mutable, but strictly protected objects enriched with <em>runtime type information</em>. In other words, each tree has a <em>shape</em> (type information) and <em>state</em> (data).
From this living tree, immutable, structurally shared, snapshots are automatically generated.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">import</span> { types, onSnapshot } <span class="hljs-keyword">from</span> <span class="hljs-string">"mobx-state-tree"</span>

<span class="hljs-keyword">const</span> Todo = types
    .model(<span class="hljs-string">"Todo"</span>, {
        <span class="hljs-attr">title</span>: types.string,
        <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span>
    })
    .actions(<span class="hljs-function"><span class="hljs-params">self</span> =&gt;</span> ({
        toggle() {
            self.done = !self.done
        }
    }))

<span class="hljs-keyword">const</span> Store = types.model(<span class="hljs-string">"Store"</span>, {
    <span class="hljs-attr">todos</span>: types.array(Todo)
})

<span class="hljs-comment">// create an instance from a snapshot</span>
<span class="hljs-keyword">const</span> store = Store.create({
    <span class="hljs-attr">todos</span>: [
        {
            <span class="hljs-attr">title</span>: <span class="hljs-string">"Get coffee"</span>
        }
    ]
})

<span class="hljs-comment">// listen to new snapshots</span>
onSnapshot(store, snapshot =&gt; {
    <span class="hljs-built_in">console</span>.dir(snapshot)
})

<span class="hljs-comment">// invoke action that modifies the tree</span>
store.todos[<span class="hljs-number">0</span>].toggle()
<span class="hljs-comment">// prints: `{ todos: [{ title: "Get coffee", done: true }]}`</span>
</code></pre>
<p>By using the type information available, snapshots can be converted to living trees, and vice versa, with zero effort.
Because of this, <a href="https://github.com/mobxjs/mobx-state-tree/blob/master/packages/mst-example-boxes/src/stores/time.js">time travelling</a> is supported out of the box, and tools like HMR are trivial to support <a href="https://github.com/mobxjs/mobx-state-tree/blob/4c2b19ec4a6a8d74064e4b8a87c0f8b46e97e621/examples/boxes/src/stores/domain-state.js#L94">example</a>.</p>
<p>The type information is designed in such a way that it is used both at design- and run-time to verify type correctness (Design time type checking works in TypeScript only at the moment; Flow PR's are welcome!)</p>
<pre><code class="hljs">[mobx-state-tree] <span class="hljs-keyword">Value</span> <span class="hljs-string">'{\"todos\":[{\"turtle\":\"Get tea\"}]}'</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> assignable <span class="hljs-keyword">to</span> <span class="hljs-keyword">type</span>: Store, expected an instance <span class="hljs-keyword">of</span> Store <span class="hljs-keyword">or</span> a <span class="hljs-keyword">snapshot</span> <span class="hljs-keyword">like</span> <span class="hljs-string">'{ todos: { title: string; done: boolean }[] }'</span> <span class="hljs-keyword">instead</span>.
</code></pre>
<p><em>Runtime type error</em></p>
<p><img src="docs/tserror.png" alt="typescript error"></p>
<p><em>Designtime type error</em></p>
<p>Because state trees are living, mutable models, actions are straight-forward to write; just modify local instance properties where appropriate. See <code>toggleTodo()</code> above or the examples below. It is not necessary to produce a new state tree yourself, MST's snapshot functionality will derive one for you automatically.</p>
<p>Although mutable sounds scary to some, fear not, actions have many interesting properties.
By default trees can only be modified by using an action that belongs to the same subtree.
Furthermore, actions are replayable and can be used to distribute changes (<a href="https://github.com/mobxjs/mobx-state-tree/blob/master/packages/mst-example-boxes/src/stores/socket.js">example</a>).</p>
<p>Moreover, because changes can be detected on a fine grained level, JSON patches are supported out of the box.
Simply subscribing to the patch stream of a tree is another way to sync diffs with, for example, back-end servers or other clients (<a href="https://github.com/mobxjs/mobx-state-tree/blob/master/packages/mst-example-boxes/src/stores/socket.js">example</a>).</p>
<p><img src="docs/patches.png" alt="patches"></p>
<p>Since MST uses MobX behind the scenes, it integrates seamlessly with <a href="https://mobx.js.org">mobx</a> and <a href="https://github.com/mobxjs/mobx-react">mobx-react</a>. See also this <a href="https://egghead.io/lessons/react-render-mobx-state-tree-models-in-react">egghead.io lesson: Render mobx-state-tree Models in React</a>.
Even cooler, because it supports snapshots, middleware and replayable actions out of the box, it is possible to replace a Redux store and reducer with a MobX state tree.
This makes it possible to connect the Redux devtools to MST. See the <a href="https://github.com/mobxjs/mobx-state-tree/blob/1906a394906d2e8f2cc1c778e1e3228307c1b112/packages/mst-example-redux-todomvc/src/index.js#L6">Redux / MST TodoMVC example</a>.</p>
<hr>
<p>For futher reading: the conceptual difference between snapshots, patches and actions in relation to distributing state changes is extensively discussed in this <a href="https://medium.com/@mweststrate/distributing-state-changes-using-snapshots-patches-and-actions-part-1-2811a2fcd65f">blog post</a></p>
<p><img src="docs/reduxdevtools.png" alt="devtools"></p>
<p>Finally, MST has built-in support for references, identifiers, dependency injection, change recording and circular type definitions (even across files).
Even fancier, it analyses liveliness of objects, failing early when you try to access accidentally cached information! (More on that later)</p>
<p>A unique feature of MST is that it offers liveliness guarantees. MST will throw when reading or writing from objects that are no longer part of a state tree. This protects you against accidental stale reads of objects still referred by, for example, a closure.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> oldTodo = store.todos[<span class="hljs-number">0</span>]
store.removeTodo(<span class="hljs-number">0</span>)

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logTodo</span>(<span class="hljs-params">todo</span>) </span>{
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(todo.title), <span class="hljs-number">1000</span>)
}

logTodo(store.todos[<span class="hljs-number">0</span>])
store.removeTodo(<span class="hljs-number">0</span>)
<span class="hljs-comment">// throws exception in one second for using an stale object!</span>
</code></pre>
<p>Despite all that, you will see that the <a href="docs/API/README.md">API</a> is quite straightforward!</p>
<hr>
<p>Another way to look at mobx-state-tree is to consider it, as argued by Daniel Earwicker, to be <a href="http://danielearwicker.github.io/json_mobx_Like_React_but_for_Data_Part_2.html">&quot;React, but for data&quot;</a>.
Like React, MST consists of composable components, called <em>models</em>, which captures a small piece of state. They are instantiated from props (snapshots) and after that manage and protect their own internal state (using actions). Moreover, when applying snapshots, tree nodes are reconciled as much as possible. There is even a context-like mechanism, called environments, to pass information to deep descendants.</p>
<p>An introduction to the philosophy can be watched <a href="https://youtu.be/ta8QKmNRXZM?t=21m52s">here</a>. <a href="https://immer-mutable-state.surge.sh/">Slides</a>. Or, as <a href="https://github.com/mweststrate/reactive2016-slides/blob/master/slides.md">markdown</a> to read it quickly.</p>
<p>mobx-state-tree &quot;immutable trees&quot; and &quot;graph model&quot; features talk, <a href="https://www.youtube.com/watch?v=rwqwwn_46kA">&quot;Next Generation State Management&quot;</a> at React Europe 2017. <a href="http://tree.surge.sh/#1">Slides</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-next button" href="/intro/installation"><span>Installation</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/favicon.ico" alt="MobX-state-tree" width="66" height="58"/></a><div><h5>Docs</h5><a href="/en/doc1.html">Getting Started (or other categories)</a><a href="/en/doc2.html">Guides (or other categories)</a><a href="/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" href="https://github.com/mobxjs/mobx-state-tree" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 Michel Weststrate</section></footer></div></body></html>